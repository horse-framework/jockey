import{a as ie}from"./chunk-U2DSLRRK.js";import{a as O,b as k,c as E,d as P,e as D,f as oe}from"./chunk-2C4VCG6N.js";import{b as Y,c as $,f as ee,h as te,n as ne}from"./chunk-NJ67TIRQ.js";import{a as X}from"./chunk-IARL6YQG.js";import{Aa as _,Bb as J,Fa as M,Ga as t,Ha as n,Ia as Z,M as B,Ma as N,N as z,Pa as s,Pb as Q,Q as L,Qa as p,U as y,V as S,Xa as o,Ya as d,Za as H,ab as f,bb as C,cb as u,d as F,g as A,ia as m,ib as v,kb as x,ra as g,ua as h,ub as q,va as U,vb as w,wb as I,xb as G,y as R,ya as K}from"./chunk-I3ZBIMQN.js";var b=class l{#e=L(J);list(){return this.#e.get("/cache/list",{observe:"response"})}get(c){return this.#e.get("/cache/get?key="+c,{observe:"response"})}remove(c){return this.#e.delete("/cache/remove?key="+c,{observe:"response"})}create(c,e,i,r,a){let me={key:c,content:e,duration:i,expirationWarning:r,tags:a};return this.#e.post("/cache/create",me,{observe:"response"})}static \u0275fac=function(e){return new(e||l)};static \u0275prov=B({token:l,factory:l.\u0275fac,providedIn:"root"})};function se(l,c){if(l&1&&(t(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9),o(4,"Expiration"),n(),t(5,"div",10),o(6),v(7,"date"),n()(),t(8,"div",8)(9,"div",9),o(10,"Warning Time"),n(),t(11,"div",10),o(12),v(13,"date"),n()(),t(14,"div",8)(15,"div",9),o(16,"Warn Count"),n(),t(17,"div",10),o(18),n()(),t(19,"div",8)(20,"div",9),o(21,"Tags"),n(),t(22,"div",10),o(23),n()()(),t(24,"textarea",11),o(25),n()()),l&2){let e=p();m(6),d(x(7,5,e.model.expiration*1e3,"yyyy-MM-dd HH:mm:ss")),m(6),d(x(13,8,e.model.warningDate*1e3,"yyyy-MM-dd HH:mm:ss")),m(6),d(e.model.warnCount),m(5),d(e.model.tags.join(", ")),m(2),d(e.model.value)}}var W=class l{constructor(c,e){this.cacheService=c;this.dialog=e}model=null;ngOnInit(){}remove(){this.cacheService.remove(this.model.key).subscribe(()=>{this.dialog.closeAll()})}static \u0275fac=function(e){return new(e||l)(g(b),g(O))};static \u0275cmp=h({type:l,selectors:[["app-cache-view-modal"]],standalone:!1,decls:9,vars:2,consts:[["mat-dialog-title","",1,"title"],[1,"content"],["class","cache-value",4,"ngIf"],[1,"buttons"],["mat-button","","mat-dialog-close","",1,"modal-btn","btn-grey"],["mat-button","",1,"modal-btn","btn-red",3,"click"],[1,"cache-value"],[1,"key-value-table"],[1,"kvt-row"],[1,"kvt-key-narrow"],[1,"kvt-value"],["readonly","",2,"cursor","text"]],template:function(e,i){e&1&&(t(0,"h2",0),o(1),n(),t(2,"mat-dialog-content",1),_(3,se,26,11,"div",2),n(),t(4,"mat-dialog-actions",3)(5,"button",4),o(6,"Close"),n(),t(7,"button",5),s("click",function(){return i.remove()}),o(8,"Remove"),n()()),e&2&&(m(),d(i.model==null?null:i.model.key),m(2),M("ngIf",i.model))},dependencies:[w,k,E,D,P,I],styles:[".title[_ngcontent-%COMP%]{color:#eee}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d2d2d2;font-size:14px;line-height:30px}.cache-value[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:8px 0;border:1px solid #333;background-color:#000;padding:15px;border-radius:12px;width:480px;height:220px;font-family:Courier New,Courier,monospace;font-size:13px;font-weight:400;color:#eee;resize:none}"]})};var j=class l{model;_onconfirmed=new A;get onconfirmed(){return this._onconfirmed}_confirmed=!1;constructor(){this.model={key:"",duration:60,expirationWarning:0,tags:[],tagsAll:"",content:""}}ngOnInit(){}ngOnDestroy(){this._confirmed||this._onconfirmed.next(null)}create(){this.model.key=this.model.key.trim(),!(this.model.key.length<1)&&(this.model.tagsAll.length>0&&(this.model.tags=this.model.tagsAll.split(",").map(c=>c.trim()).filter(c=>c.length>0)),this._confirmed=!0,this._onconfirmed.next(this.model))}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=h({type:l,selectors:[["app-cache-create-modal"]],standalone:!1,decls:29,vars:5,consts:[["mat-dialog-title","",1,"title"],[1,"content"],[1,"form-item"],["placeholder","Cache Key","type","text",1,"jockey-text",3,"ngModelChange","ngModel"],["placeholder","Duration in seconds","type","number",1,"jockey-text",3,"ngModelChange","ngModel"],["placeholder","Zero for disabled. In seconds.","type","number",1,"jockey-text",3,"ngModelChange","ngModel"],["placeholder","Type multiple tags with comma seperator","type","text",1,"jockey-text",3,"ngModelChange","ngModel"],["placeholder","Cache Item Content","type","text",1,"jockey-text",3,"ngModelChange","ngModel"],[1,"buttons"],["mat-button","","mat-dialog-close","",1,"modal-btn","btn-blue",3,"click"],["mat-button","","mat-dialog-close","",1,"modal-btn","btn-grey"]],template:function(e,i){e&1&&(t(0,"h2",0),o(1,"Create Cache Item"),n(),t(2,"mat-dialog-content",1)(3,"div")(4,"div",2)(5,"label"),o(6,"Key"),n(),t(7,"input",3),u("ngModelChange",function(a){return C(i.model.key,a)||(i.model.key=a),a}),n()(),t(8,"div",2)(9,"label"),o(10,"Duration"),n(),t(11,"input",4),u("ngModelChange",function(a){return C(i.model.duration,a)||(i.model.duration=a),a}),n()(),t(12,"div",2)(13,"label"),o(14,"Warning Duration"),n(),t(15,"input",5),u("ngModelChange",function(a){return C(i.model.expirationWarning,a)||(i.model.expirationWarning=a),a}),n()(),t(16,"div",2)(17,"label"),o(18,"Tags"),n(),t(19,"input",6),u("ngModelChange",function(a){return C(i.model.tagsAll,a)||(i.model.tagsAll=a),a}),n()(),t(20,"div",2)(21,"label"),o(22,"Value"),n(),t(23,"textarea",7),u("ngModelChange",function(a){return C(i.model.content,a)||(i.model.content=a),a}),n()()()(),t(24,"mat-dialog-actions",8)(25,"button",9),s("click",function(){return i.create()}),o(26,"Create"),n(),t(27,"button",10),o(28,"Cancel"),n()()),e&2&&(m(7),f("ngModel",i.model.key),m(4),f("ngModel",i.model.duration),m(4),f("ngModel",i.model.expirationWarning),m(4),f("ngModel",i.model.tagsAll),m(4),f("ngModel",i.model.content))},dependencies:[k,E,D,P,Y,te,$,ee],styles:[".title[_ngcontent-%COMP%]{color:#eee}.content[_ngcontent-%COMP%]{padding:0 25px 10px;display:block}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d2d2d2;font-size:14px;line-height:30px}.target-text[_ngcontent-%COMP%]{border:1px solid #555;background-color:#000;color:#eee;font-size:14px;font-weight:500;padding:8px;width:320px}.target-text[_ngcontent-%COMP%]:focus, .target-text[_ngcontent-%COMP%]:active{border-color:#10a040}.form-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;align-content:stretch;align-items:stretch;justify-content:stretch;justify-items:stretch;padding:8px 0}.form-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1 1 auto;color:#bbb;font-size:13px;font-weight:500}.form-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto}.form-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{font-family:Ubuntu,sans-serif;height:120px;line-height:20px;resize:none;border-radius:12px;border-color:#555}"]})};function pe(l,c){if(l&1){let e=N();t(0,"div",13),Z(1,"div",14),t(2,"div",15)(3,"span"),o(4),n()(),t(5,"div",16)(6,"span"),o(7),v(8,"date"),n()(),t(9,"div",16)(10,"span"),o(11),v(12,"date"),n()(),t(13,"div",17)(14,"span"),o(15),n()(),t(16,"div",18)(17,"span"),o(18),n()(),t(19,"div",19)(20,"button",20),s("click",function(){let r=y(e).$implicit,a=p(2);return S(a.remove(r.key))}),o(21,"Remove"),n(),t(22,"button",21),s("click",function(){let r=y(e).$implicit,a=p(2);return S(a.view(r.key))}),o(23,"View"),n()()()}if(l&2){let e=c.$implicit;m(4),d(e.key),m(3),H("",x(8,5,e.expiration*1e3,"yyyy-MM-dd HH:mm:ss")," UTC"),m(4),H("",x(12,8,e.warningDate*1e3,"yyyy-MM-dd HH:mm:ss")," UTC"),m(4),d(e.warnCount),m(3),d(e.tags.join(", "))}}function ge(l,c){if(l&1){let e=N();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"a",5),s("click",function(){y(e);let r=p();return S(r.create())}),n()(),t(5,"div",6),o(6,"Key"),n(),t(7,"div",7),o(8,"Expiration"),n(),t(9,"div",7),o(10,"Warning Date"),n(),t(11,"div",8),o(12,"Warn Count"),n(),t(13,"div",9),o(14,"Tags"),n(),t(15,"div",10),o(16,"Action"),n()(),t(17,"div",11),_(18,pe,24,11,"div",12),n()()()}if(l&2){let e=p();m(18),M("ngForOf",e.caches)}}var V=class l extends X{constructor(e,i){super();this.cacheService=e;this.dialog=i}caches=[];ngOnInit(){return F(this,null,function*(){this.cacheService.list().subscribe(e=>{this.caches=e.body,this.subscribeToListRefresh().subscribe(()=>this.cacheService.list().subscribe(i=>this.caches=i.body))})})}remove(e){this.cacheService.remove(e).subscribe(i=>{this.cacheService.list().subscribe(r=>this.caches=r.body)})}view(e){return F(this,null,function*(){this.cacheService.get(e).subscribe(i=>{if(i.ok){let a=this.dialog.open(W,{width:"700px"}).componentInstance;a.model=i.body}})})}create(){this.dialog.open(j,{width:"600px"}).componentInstance.onconfirmed.pipe(R(1)).subscribe(r=>{r&&this.cacheService.create(r.key,r.content,r.duration,r.expirationWarning,r.tags).subscribe(a=>{a.ok&&this.ngOnInit()})})}static \u0275fac=function(i){return new(i||l)(g(b),g(O))};static \u0275cmp=h({type:l,selectors:[["app-cache"]],standalone:!1,features:[K],decls:1,vars:1,consts:[["class","cache",4,"ngIf"],[1,"cache"],[1,"table"],[1,"thead"],[1,"th","fx40px"],["title","Create New Item",1,"fa","fa-solid","fa-plus","hreverse",3,"click"],[1,"th","fx20"],[1,"th","fx14"],[1,"th","fx8"],[1,"th","fx26"],[1,"th","fx16","tright",2,"display","block"],[1,"tbody"],["class","trow",4,"ngFor","ngForOf"],[1,"trow"],[1,"td","fx40px"],[1,"td","fx20"],[1,"td","fx14"],[1,"td","fx8"],[1,"td","fx26"],[1,"td","fx16","tright"],[1,"cache-button","red",3,"click"],[1,"cache-button","blue",3,"click"]],template:function(i,r){i&1&&_(0,ge,19,1,"div",0),i&2&&M("ngIf",r.caches)},dependencies:[q,w,I],styles:[".cache[_ngcontent-%COMP%]{margin:auto;padding:0 60px;text-align:center}.cache[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{width:100%;text-align:left}.cache-button[_ngcontent-%COMP%]{border:2px solid transparent;border-radius:2px;color:#f0f0f0;padding:6px 10px;min-width:70px;margin:-6px 0 -6px 14px;background-color:transparent}.cache-button.red[_ngcontent-%COMP%]{border-color:#c02020}.cache-button.red[_ngcontent-%COMP%]:hover{border-color:#f02020}.cache-button.blue[_ngcontent-%COMP%]{border-color:#1050a0}.cache-button.blue[_ngcontent-%COMP%]:hover{border-color:#1070c0}"]})};var ce=class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=U({type:l});static \u0275inj=z({imports:[G,ie,oe,ne,Q.forChild([{path:"",component:V}])]})};export{ce as CacheModule};
