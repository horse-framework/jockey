import{a as G}from"./chunk-BXDPRKZC.js";import{a as A,b as q}from"./chunk-X7GHCXNM.js";import{a as B}from"./chunk-JSLFBEG5.js";import{c as w}from"./chunk-UPET6FOS.js";import"./chunk-DTICWRO3.js";import{a as T}from"./chunk-U2DSLRRK.js";import{f as j}from"./chunk-2C4VCG6N.js";import{n as W}from"./chunk-NJ67TIRQ.js";import{a as P}from"./chunk-IARL6YQG.js";import{Aa as p,Fa as m,Fb as O,Ga as t,Ha as e,Ia as S,Ib as F,N as I,Pb as N,Qa as u,Xa as n,Ya as l,d as y,eb as C,ia as a,ib as f,kb as h,l as E,ra as v,u as b,ua as g,ub as R,va as D,vb as k,wb as M,xb as H,ya as _}from"./chunk-I3ZBIMQN.js";function $(r,o){if(r&1&&(t(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"div",17),n(5,"Id"),e(),t(6,"div",18),n(7),e()(),t(8,"div",16)(9,"div",17),n(10,"Name"),e(),t(11,"div",18),n(12),e()(),t(13,"div",16)(14,"div",17),n(15,"Type"),e(),t(16,"div",18),n(17),e()(),t(18,"div",16)(19,"div",17),n(20,"Coonected Time"),e(),t(21,"div",18),n(22),f(23,"date"),e()(),t(24,"div",16)(25,"div",17),n(26,"Queue Publish"),e(),t(27,"div",18),n(28),e()(),t(29,"div",16)(30,"div",17),n(31,"Channel Publish"),e(),t(32,"div",18),n(33),e()(),t(34,"div",16)(35,"div",17),n(36,"Router Publish"),e(),t(37,"div",18),n(38),e()(),t(39,"div",16)(40,"div",17),n(41,"Direct Send"),e(),t(42,"div",18),n(43),e()(),t(44,"div",16)(45,"div",17),n(46,"Direct Receive"),e(),t(47,"div",18),n(48),e()(),t(49,"div",16)(50,"div",17),n(51,"Cache Get"),e(),t(52,"div",18),n(53),e()(),t(54,"div",16)(55,"div",17),n(56,"Cache Set"),e(),t(57,"div",18),n(58),e()()()()()),r&2){let i=u();a(7),l(i.client.id),a(5),l(i.client.name),a(5),l(i.client.type),a(5),l(h(23,11,i.client.connectedDate*1e3,"yyyy-MM-dd HH:mm:ss")),a(6),l(i.client.stats.queuePush),a(5),l(i.client.stats.channelPublish),a(5),l(i.client.stats.routerPublish),a(5),l(i.client.stats.directSend),a(5),l(i.client.stats.directReceive),a(5),l(i.client.stats.cacheGet),a(5),l(i.client.stats.cacheSet)}}function z(r,o){if(r&1&&(t(0,"div",21)(1,"div",22)(2,"span")(3,"a",23),n(4),e()()(),t(5,"div",22)(6,"span"),n(7),f(8,"date"),e()()()),r&2){let i=o.$implicit;a(3),m("routerLink",C("/channel/",i.name)),a(),l(i.name),a(3),l(h(8,4,i.subscribedAt*1e3,"yyyy-MM-dd HH:mm:ss"))}}function J(r,o){if(r&1&&(t(0,"div",19),p(1,z,9,7,"div",20),e()),r&2){let i=u();a(),m("ngForOf",i.client.channels)}}function K(r,o){if(r&1&&(t(0,"div",21)(1,"div",22)(2,"span")(3,"a",23),n(4),e()()(),t(5,"div",22)(6,"span"),n(7),f(8,"date"),e()()()),r&2){let i=o.$implicit;a(3),m("routerLink",C("/queue/",i.name)),a(),l(i.name),a(3),l(h(8,4,i.subscribedAt*1e3,"yyyy-MM-dd HH:mm:ss"))}}function U(r,o){if(r&1&&(t(0,"div",19),p(1,K,9,7,"div",20),e()),r&2){let i=u();a(),m("ngForOf",i.client.queues)}}var x=class r extends P{constructor(i,c,d,s){super();this.activatedRoute=i;this.socket=c;this.chartService=d;this.service=s}id=null;client=null;clientChart;ngOnInit(){return y(this,null,function*(){this.id=this.activatedRoute.snapshot.params.id,yield this.load(),this.subscribeWebsockets()})}load(){this.service.get(this.id).subscribe(i=>{this.client=i.body,this.service.getGraph(this.id).subscribe(c=>{this.clientChart&&this.clientChart.destroy();let d=c;this.clientChart=new A(document.getElementById("messages-chart"),{type:"line",data:{labels:d.labels,datasets:[{label:"Direct Sent",borderColor:"#2070e0",data:d.d.map(s=>s.s),fill:!1,pointRadius:1,pointHitRadius:8,tension:.2,borderWidth:2},{label:"Direct Received",borderColor:"#f0f010",data:d.d.map(s=>s.r),fill:!1,pointRadius:1,pointHitRadius:8,tension:.2,borderWidth:2},{label:"Direct Respond",borderColor:"#10cf70",data:d.d.map(s=>s.rs),fill:!1,pointRadius:1,pointHitRadius:8,tension:.2,borderWidth:2},{label:"Direct No Receiver",borderColor:"#9a2ef0",data:d.d.map(s=>s.nr),fill:!1,pointRadius:1,pointHitRadius:8,tension:.2,borderWidth:2}]},options:{hover:{mode:"nearest",intersect:!0},animation:{duration:0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}})})})}ngOnDestroy(){super.ngOnDestroy(),this.socket.unsubscribe("client:"+this.id)}subscribeWebsockets(){this.on(this.socket.onmessage).pipe(b(i=>i.type==B.DirectGraph&&i.payload.n==this.id),b(()=>this.clientChart!=null),E(i=>i.payload)).subscribe(i=>this.chartService.updateChart(this.clientChart,i)),this.socket.subscribe("client:"+this.id)}static \u0275fac=function(c){return new(c||r)(v(O),v(w),v(q),v(G))};static \u0275cmp=g({type:r,selectors:[["app-client-detail"]],standalone:!1,features:[_],decls:38,vars:3,consts:[[1,"centered-body"],[1,"vertical-content"],[1,"dashboard-portlet"],[1,"portlet"],[1,"portlet-title"],[1,"portlet-canvas"],["id","messages-chart"],["class","portlet-body",4,"ngIf"],[1,"portlet-body","table","table-small","nowrap"],[1,"thead"],[1,"th","fx50"],["class","tbody",4,"ngIf"],[2,"height","80px"],[1,"portlet-body"],[1,"portlet-table","grow","canvas-info"],[1,"key-value-table"],[1,"kvt-row"],[1,"kvt-key"],[1,"kvt-value"],[1,"tbody"],["class","trow",4,"ngFor","ngForOf"],[1,"trow"],[1,"td","fx50"],[3,"routerLink"]],template:function(c,d){c&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),n(5,"Direct Messages"),e(),t(6,"div",5),S(7,"canvas",6),e()()(),t(8,"div",2)(9,"div",3)(10,"h3",4),n(11,"Options & Actions"),e(),p(12,$,59,14,"div",7),e()()()(),t(13,"div",0)(14,"div",1)(15,"div",2)(16,"div",3)(17,"h3",4),n(18,"Channels"),e(),t(19,"div",8)(20,"div",9)(21,"div",10),n(22,"Name"),e(),t(23,"div",10),n(24,"Subscribed Date"),e()(),p(25,J,2,1,"div",11),e()()(),t(26,"div",2)(27,"div",3)(28,"h3",4),n(29,"Queues"),e(),t(30,"div",8)(31,"div",9)(32,"div",10),n(33,"Name"),e(),t(34,"div",10),n(35,"Subscribed Date"),e()(),p(36,U,2,1,"div",11),e()()()()(),S(37,"div",12)),c&2&&(a(12),m("ngIf",d.client),a(13),m("ngIf",d.client&&d.client.channels),a(11),m("ngIf",d.client&&d.client.queues))},dependencies:[R,k,F,M],encapsulation:2})};var L=class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=D({type:r});static \u0275inj=I({imports:[H,T,j,W,N.forChild([{path:":id",component:x}])]})};export{L as ClientDetailModule};
