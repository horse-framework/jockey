import{a as V}from"./chunk-JSLFBEG5.js";import{c as Te}from"./chunk-5TYYVYVB.js";import{a as Ne}from"./chunk-H2JBVQRL.js";import{a as qe}from"./chunk-U2DSLRRK.js";import{b as ke,c as Se,d as Me,e as Ee,f as Ie,g as Ve,i as je,j as Pe,k as Re,n as De}from"./chunk-NJ67TIRQ.js";import{A as W,Aa as f,B as Y,C as ee,D as te,Ea as de,Fa as g,G as ne,Ga as r,H as j,Ha as s,Ia as I,J as C,Ja as A,Ka as L,La as ge,M as oe,Ma as x,N as ie,Pa as u,Pb as ve,Qa as d,Ra as h,Sa as _,Ta as b,U as p,V as m,Va as w,Xa as l,Za as ue,aa as P,ab as v,bb as T,cb as k,f as z,fb as fe,g as M,ga as re,gb as he,h as H,hb as _e,i as J,ia as a,ib as Q,j as N,jb as $,l as B,la as se,lb as be,na as ae,r as Z,ra as y,s as U,sa as le,t as G,tb as Ce,u as E,ua as ce,va as pe,vb as ye,wb as xe,x as K,xa as me,xb as we,y as O,z as X}from"./chunk-I3ZBIMQN.js";var S=class i extends z{_destroy$=new M;constructor(){super(t=>this._destroy$.subscribe(t))}ngOnDestroy(){this._destroy$.next(null),this._destroy$.complete()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=oe({token:i,factory:i.\u0275fac})};var R=class i{constructor(t){this._datePipe=t}transform(t){return this._datePipe.transform(t*1e3,"HH:mm:ss")}static \u0275fac=function(e){return new(e||i)(y(xe,16))};static \u0275pipe=me({name:"jockeyTime",type:i,pure:!0,standalone:!1})};var Qe=["container"],$e=["consoleContainer"],Fe=["consoleTable"],ze=["messageTemplate"],He=["searchInput"],Je=["applied"],Be=(i,t)=>({"red-button":i,"green-button":t}),Ze=i=>({"time-show":i});function Ue(i,t){if(i&1){let e=x();r(0,"select",26),k("ngModelChange",function(o){p(e);let c=d(2);return T(c.targetType,o)||(c.targetType=o),m(o)}),r(1,"option",27),l(2,"Target by Name"),s(),r(3,"option",28),l(4,"Target by Topic"),s()()}if(i&2){let e=d(2);v("ngModel",e.targetType)}}function Ge(i,t){if(i&1){let e=x();r(0,"select",26),k("ngModelChange",function(o){p(e);let c=d(2);return T(c.targetType,o)||(c.targetType=o),m(o)}),r(1,"option",29),l(2,"Target by Id"),s(),r(3,"option",27),l(4,"Target by Name"),s(),r(5,"option",30),l(6,"Target by Type"),s()()}if(i&2){let e=d(2);v("ngModel",e.targetType)}}function Ke(i,t){if(i&1){let e=x();A(0),r(1,"select",17),k("ngModelChange",function(o){p(e);let c=d();return T(c.source,o)||(c.source=o),m(o)}),r(2,"option",18),l(3,"Queue"),s(),r(4,"option",19),l(5,"Channel"),s(),r(6,"option",20),l(7,"Router"),s(),r(8,"option",21),l(9,"Direct"),s()(),f(10,Ue,5,1,"select",22)(11,Ge,7,1,"select",22),r(12,"input",23),k("ngModelChange",function(o){p(e);let c=d();return T(c.target,o)||(c.target=o),m(o)}),s(),r(13,"button",24),u("click",function(){p(e);let o=d();return m(o.submit())}),l(14,"Apply Filter"),s(),r(15,"button",25),u("click",function(){p(e);let o=d();return m(o.subscribeAll())}),l(16,"Subscribe to all events"),s(),L()}if(i&2){let e=d();a(),v("ngModel",e.source),a(9),g("ngIf",e.source=="queue"),a(),g("ngIf",e.source=="direct"),a(),v("ngModel",e.target)}}function Xe(i,t){if(i&1){let e=x();A(0),r(1,"button",31),u("click",function(){p(e);let o=d();return m(o.unsubscribeAll())}),l(2,"Unsubscribe from all events"),s(),L()}}function Ye(i,t){if(i&1&&(I(0,"td",38),Q(1,"jockeyTime")),i&2){let e=d().$implicit;g("textContent",$(1,1,e.date))}}function et(i,t){if(i&1&&(r(0,"td",39)(1,"span"),l(2),s()()),i&2){let e=d().$implicit;a(2),ue("[",e.contentType,"]")}}function tt(i,t){if(i&1&&(r(0,"tr"),I(1,"td",40),s()),i&2){let e=d().$implicit;a(),g("textContent",e.messageId)}}function nt(i,t){if(i&1&&(r(0,"tr"),f(1,Ye,2,3,"td",32),I(2,"td",33),f(3,et,3,1,"td",34),r(4,"td",35)(5,"table"),f(6,tt,2,1,"tr",9),r(7,"tr")(8,"td",36),I(9,"pre",37),Q(10,"prettyprint"),s()()()()()),i&2){let e=t.$implicit,n=d();a(),g("ngIf",n.showTime),a(),g("ngClass",he(9,Ze,n.showTime))("textContent",e.name),a(),g("ngIf",n.showContentType),a(3),g("ngIf",n.showMessageId),a(2),de("colspan",n.colspan),a(),g("innerHTML",n.isJson?$(10,7,e.messageObj):e.message,re)}}var D=class i{constructor(t,e,n){this._destroy$=t;this._socket$=e;this._ngZone=n}source="queue";targetType="name";target="";search="";showTime=!0;showMessageId=!0;showContentType=!1;autoScroll=!0;isJson=!1;clearTrigger$=new M;triggerFilter$=new M;pause=!1;allSubscribed=!1;container;consoleContainer;consoleTable;messageTemplate;searchInput;applied;get colspan(){let t=0;return this.showMessageId&&t++,t}_messageLimit=1e4;_renderLimit=200;_renderedMessage=0;_pause$=new H(!1);_messages=new Set;ngOnDestroy(){this.unsubscribeAll()}ngOnInit(){Z(this.searchInput.nativeElement,"input").pipe(j(this._destroy$),K(750),Y(),C(()=>{this.consoleContainer.clear(),this._renderedMessage=0}),ne(()=>J(this._messages).pipe(this.isInFilter(),ee(this._renderLimit),this.renderMessage()))).subscribe(),G(this._socket$.onmessage.pipe(E(t=>t.type===V.ConsoleMessage),te("payload"),B(t=>{try{t.messageObj=JSON.parse(t.message)}catch{}return t}),C(t=>{if(this._messages.size>=this._messageLimit){let e=this._messages.values().next();this._messages.delete(e.value)}this._messages.add(t)}),X(()=>this._pause$.pipe(E(t=>!t))),this.isInFilter(),this.renderMessage()),this.clearTrigger$.pipe(C(()=>{this.consoleContainer.clear(),this._messages.clear(),this._renderedMessage=0}))).pipe(j(this._destroy$)).subscribe(),this._ngZone.runOutsideAngular(()=>{U(10).pipe(j(this._destroy$),E(()=>this.autoScroll&&!this.pause&&this.consoleTable.nativeElement.scrollTop!==this.consoleTable.nativeElement.scrollHeight),C(()=>this.container.nativeElement.scrollTo({top:this.container.nativeElement.scrollHeight}))).subscribe()})}toggleTime(){this.showTime=!this.showTime}toggleMessageId(){this.showMessageId=!this.showMessageId}toggleContentType(){this.showContentType=!this.showContentType}toggleAutoScroll(){this.autoScroll=!this.autoScroll}toggleJson(){this.isJson=!this.isJson}togglePause(){this.pause=!this.pause,this._pause$.next(this.pause)}submit(){let t={requestId:new Date().getTime().toString(),source:this.source,targetType:this.targetType,target:this.target};this._socket$.send(V.ConsoleRequest,t),this.applied.nativeElement.setAttribute("class","applied show"),N(this.applied).pipe(W(1e3),O(1)).subscribe(e=>e.nativeElement.setAttribute("class","applied"))}clear(){this.clearTrigger$.next(null)}isInFilter=()=>t=>t.pipe(E(e=>this.search.length<1?!0:e.messageId.includes(this.search)||e.message.includes(this.search)));renderMessage=()=>t=>t.pipe(C(e=>{this._renderedMessage>=this._renderLimit&&(this.consoleTable.nativeElement.firstChild?.remove(),this._renderedMessage--),this.consoleContainer.createEmbeddedView(this.messageTemplate,{$implicit:e}).detectChanges(),this._renderedMessage++}));subscribeAll(){let t={requestId:new Date().getTime().toString(),source:"all",targetType:"name",target:"*"};this._socket$.send(V.ConsoleRequest,t),this.allSubscribed=!0,this.applied.nativeElement.setAttribute("class","applied show"),N(this.applied).pipe(W(1e3),O(1)).subscribe(e=>e.nativeElement.setAttribute("class","applied"))}unsubscribeAll(){let t={requestId:new Date().getTime().toString(),source:"all",targetType:"name",target:""};this._socket$.send(V.ConsoleRequest,t),this.allSubscribed=!1}static \u0275fac=function(e){return new(e||i)(y(S),y(Te),y(se))};static \u0275cmp=ce({type:i,selectors:[["app-console"]],viewQuery:function(e,n){if(e&1&&(h(Qe,7),h($e,7,le),h(Fe,7,P),h(ze,7,ae),h(He,7,P),h(Je,7,P)),e&2){let o;_(o=b())&&(n.container=o.first),_(o=b())&&(n.consoleContainer=o.first),_(o=b())&&(n.consoleTable=o.first),_(o=b())&&(n.messageTemplate=o.first),_(o=b())&&(n.searchInput=o.first),_(o=b())&&(n.applied=o.first)}},standalone:!1,features:[fe([S])],decls:33,vars:18,consts:[["applied",""],["searchInput",""],["container",""],["consoleTable",""],["consoleContainer",""],["messageTemplate",""],[1,"console-frame"],[1,"console-panel"],[1,"console-filter"],[4,"ngIf"],[1,"applied"],[1,"console-buttons"],["type","text","name","search","placeholder","Search in messages",3,"ngModelChange","ngModel"],[1,"toggle-button",3,"click"],[1,"red-button",3,"click"],[3,"click","ngClass","textContent"],[1,"console"],["name","source",3,"ngModelChange","ngModel"],["value","queue","selected",""],["value","channel"],["value","router"],["value","direct"],["name","targetType",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","target","placeholder","Type target",1,"jockey-text",3,"ngModelChange","ngModel"],[1,"blue",3,"click"],[1,"yellow",3,"click"],["name","targetType",3,"ngModelChange","ngModel"],["value","name"],["value","topic"],["value","id"],["value","type"],[1,"red",3,"click"],["class","message-time",3,"textContent",4,"ngIf"],[1,"message-name",3,"ngClass","textContent"],["class","message-content-type",4,"ngIf"],[1,"message-container"],[1,"message-content"],[1,"dark-mode",3,"innerHTML"],[1,"message-time",3,"textContent"],[1,"message-content-type"],[1,"message-id",3,"textContent"]],template:function(e,n){if(e&1){let o=x();r(0,"div",6)(1,"div",7)(2,"div",8)(3,"form"),f(4,Ke,17,4,"ng-container",9)(5,Xe,3,0,"ng-container",9),r(6,"span",10,0),l(8,"Applied"),s()()(),r(9,"div",11)(10,"input",12,1),k("ngModelChange",function(q){return p(o),T(n.search,q)||(n.search=q),m(q)}),s(),r(12,"span",13),u("click",function(){return p(o),m(n.toggleTime())}),l(13," Time "),s(),r(14,"span",13),u("click",function(){return p(o),m(n.toggleMessageId())}),l(15," Message Id "),s(),r(16,"span",13),u("click",function(){return p(o),m(n.toggleContentType())}),l(17," Content Type "),s(),r(18,"span",13),u("click",function(){return p(o),m(n.toggleJson())}),l(19," JSON "),s(),r(20,"span",13),u("click",function(){return p(o),m(n.toggleAutoScroll())}),l(21," Auto Scroll "),s(),r(22,"span",14),u("click",function(){return p(o),m(n.clear())}),l(23," Clear Console "),s(),r(24,"span",15),u("click",function(){return p(o),m(n.togglePause())}),s()()(),r(25,"div",16,2)(27,"table",null,3),ge(29,null,4),s()()(),f(31,nt,11,11,"ng-template",null,5,be)}e&2&&(a(4),g("ngIf",!n.allSubscribed),a(),g("ngIf",n.allSubscribed),a(5),v("ngModel",n.search),a(2),w("active",n.showTime),a(2),w("active",n.showMessageId),a(2),w("active",n.showContentType),a(2),w("active",n.isJson),a(2),w("active",n.autoScroll),a(4),g("ngClass",_e(15,Be,!n.pause,n.pause))("textContent",n.pause?">":"II"))},dependencies:[Ce,ye,Ve,Pe,Re,ke,je,Se,Me,Ie,Ee,R,Ne],styles:[`.console-frame{padding:0 60px;display:flex;flex-direction:column;margin:auto;align-content:stretch;align-items:stretch;height:calc(100vh - 110px)}.console-panel{display:flex;flex:0 1 auto;flex-direction:row;align-items:stretch;align-content:space-between}.console-filter{flex:1 0 auto;padding:0 0 12px}.console-filter form{display:flex;flex-direction:row;align-items:stretch;align-content:flex-start;height:42px}.console-filter select{border-radius:2px;border:1px solid #333;background-color:#111;color:#eee;padding:6px;margin:0 10px 0 0;line-height:30px;height:32px;box-sizing:border-box}.console-filter input,.console-buttons input{border-radius:12px;border:1px solid #333;background-color:#111;color:#eee;margin:0 10px 0 0;line-height:32px;height:32px}.console-filter button{border-radius:12px;border:none;color:#eee;box-sizing:border-box;padding:6px 12px;margin:0 10px 0 0;height:35px;font-size:12px;font-weight:600;cursor:pointer}.console-filter button.green{background-color:#108030}.console-filter button.blue{background-color:#048cca}.console-filter button.green:hover{background-color:#129040}.console-filter button.yellow{background-color:#a27010}.console-filter button.yellow:hover{background-color:#b09020}.console-filter button.red{background-color:#d01010}.console-filter button.red:hover{background-color:#ff2020}.console-buttons{flex:0 1 auto;padding-top:0}.toggle-button{margin:0 4px;border-radius:12px;background-color:#333;color:#ccc;padding:8px 10px;line-height:20px;font-size:13px;font-weight:400;cursor:pointer}.toggle-button:hover{background-color:#111}.toggle-button.active{background-color:#f0d000;color:#000}.toggle-button:hover.active{background-color:#f0e060}.red-button{margin:0 0 0 4px;border-radius:12px;background-color:#d01010;color:#fff;padding:8px 10px;line-height:20px;font-size:13px;font-weight:400;cursor:pointer}.red-button:hover{background-color:#ff3030}.green-button{margin:0 0 0 4px;border-radius:2px;background-color:#43a047;color:#fff;padding:8px 10px;line-height:20px;font-size:13px;font-weight:400;cursor:pointer}.green-button:hover{background-color:#4caf50}.console{background-color:#101010;border:1px solid #333;flex:1 1 auto;border-radius:12px;display:flex;flex-direction:column;align-content:stretch;align-items:stretch;overflow:auto;padding:10px 14px;font-family:Ubuntu Mono,monospace}.message-time{color:#999;font-size:13px;font-style:normal;line-height:20px;font-weight:400;vertical-align:initial;width:1%;white-space:nowrap}td.message-name{font-weight:700;color:#f0d000;font-size:14px;padding-right:16px;width:1%;white-space:nowrap}td.message-name.time-show{padding:0 16px}td.message-content-type{width:1%;white-space:nowrap;padding:0 16px 0 0}td.message-content-type>span{color:#20a0a0;font-size:14px;font-style:normal;font-weight:700}td.message-id{color:#888;font-size:11px;font-weight:400}td.message-content{width:100%;font-weight:400;color:#f0f0f0}td.message-content>div{word-break:break-word;white-space:pre-line}td>table{width:100%;margin-bottom:8px}table td{white-space:nowrap;vertical-align:initial}table td.message{white-space:normal}pre{margin:0}.json-key{color:brown}.json-string{color:olive}.json-number{color:navy}.json-boolean{color:teal}.json-null{color:#696969}.json-mark{color:#000}a.json-link{color:purple;transition:all .4s}a.json-link:visited{color:#708090}a.json-link:hover{color:#8a2be2}a.json-link:active{color:#708090}.dark-mode .json-key{color:#cd5c5c}.dark-mode .json-string{color:#bdb76b}.dark-mode .json-number{color:#00bfff}.dark-mode .json-boolean{color:#3cb371}.dark-mode .json-null{color:#ff8c00}.dark-mode .json-mark{color:silver}.dark-mode a.json-link{color:#ba55d3}.dark-mode a.json-link:visited{color:#708090}.dark-mode a.json-link:hover{color:violet}.dark-mode a.json-link:active{color:silver}.applied{padding:8px 8px 0;color:#10cc33;font-weight:500;font-size:13px;transition:.3s ease-out;opacity:0}.applied.show{opacity:1}
`],encapsulation:2,changeDetection:0})};var Oe=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=pe({type:i});static \u0275inj=ie({imports:[we,De,ve.forChild([{path:"",component:D}]),qe]})};export{Oe as ConsoleModule};
