"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[49],{4049:function(e,t,n){n.r(t),n.d(t,{ConsoleModule:function(){return m}});var o=n(38583),s=n(43057),i=n(45435),r=n(52962),c=n(68823),a=n(33018),g=n(65608),l=n(90665);function d(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"select",15),a.NdJ("ngModelChange",function(t){return a.CHM(e),a.oxw().targetType=t}),a.TgZ(1,"option",16),a._uU(2,"Target by Name"),a.qZA(),a.TgZ(3,"option",17),a._uU(4,"Target by Topic"),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.Q6J("ngModel",e.targetType)}}function u(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"select",15),a.NdJ("ngModelChange",function(t){return a.CHM(e),a.oxw().targetType=t}),a.TgZ(1,"option",18),a._uU(2,"Target by Id"),a.qZA(),a.TgZ(3,"option",16),a._uU(4,"Target by Name"),a.qZA(),a.TgZ(5,"option",19),a._uU(6,"Target by Type"),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.Q6J("ngModel",e.targetType)}}let p=(()=>{class e extends r.H{constructor(e){super(),this.socket=e,this.MessageLimit=1e3,this.source="queue",this.targetType="name",this.target="",this.search="",this.showTime=!0,this.showMessageId=!0,this.showContentType=!1,this.autoScroll=!0,this._messages=new Set,this._datePipe=new o.uU("en-US")}ngOnInit(){this.element=document.getElementById("console"),this.on(this.socket.onmessage).pipe((0,i.h)(e=>e.type==c.S.ConsoleMessage)).subscribe(e=>this.addMessage(e.payload)),(0,s.F)(100).subscribe(()=>{this.autoScroll&&(this.element.scrollTop=this.element.scrollHeight)})}ngOnDestroy(){super.ngOnDestroy();let e={requestId:(new Date).getTime().toString(),source:null,targetType:null,target:null};this.socket.send(c.S.ConsoleRequest,e)}toggleTime(){this.showTime=!this.showTime,this.redraw()}toggleMessageId(){this.showMessageId=!this.showMessageId,this.redraw()}toggleContentType(){this.showContentType=!this.showContentType,this.redraw()}toggleAutoScroll(){this.autoScroll=!this.autoScroll}searching(e){this.redraw()}submit(){let e={requestId:(new Date).getTime().toString(),source:this.source,targetType:this.targetType,target:this.target};this.socket.send(c.S.ConsoleRequest,e)}clear(){this._messages.clear(),this.redraw()}redraw(){let e="";this._messages.forEach(t=>{this.isInFilter(t)&&(e+=this.createMessageHtml(t))}),this.element.innerHTML=e,this.element.scrollTop=this.element.scrollHeight}addMessage(e){if(this._messages.size>2e3)for(let n=0;n<500;n++){var t=this._messages.values().next();this._messages.delete(t.value)}this._messages.add(e),this.isInFilter(e)&&this.element.appendChild(this.createMessageElement(e))}createMessageElement(e){let t=(this.showTime?"<em>"+this._datePipe.transform(1e3*e.date,"HH:mm:ss")+"</em>":"")+"<strong>"+e.name+"</strong>"+(this.showContentType?"<span>"+e.contentType+"</span>":"")+"<div>"+(this.showMessageId?"<b>"+e.messageId+"</b>":"")+"<p>"+e.message+"</p>",n=document.createElement("div");return n.className="citem",n.innerHTML=t,n}createMessageHtml(e){return'<div class="citem">'+(this.showTime?"<em>"+this._datePipe.transform(1e3*e.date,"HH:mm:ss")+"</em>":"")+"<strong>"+e.name+"</strong>"+(this.showContentType?"<span>"+e.contentType+"</span>":"")+"<div>"+(this.showMessageId?"<b>"+e.messageId+"</b>":"")+"<p>"+e.message+"</p></div></div>"}isInFilter(e){return this.search.length<1||e.messageId.includes(this.search)||e.message.includes(this.search)}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(g.i))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-console"]],features:[a.qOj],decls:29,vars:13,consts:[[1,"console-frame"],[1,"console-panel"],[1,"console-filter"],["name","source",3,"ngModel","ngModelChange"],["value","queue","selected",""],["value","router"],["value","direct"],["name","targetType",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","target","placeholder","Type target",3,"ngModel","ngModelChange"],[3,"click"],[1,"console-buttons"],["type","text","name","search","placeholder","Search in messages",3,"ngModel","ngModelChange","input"],[1,"toggle-button",3,"click"],[1,"red-button",3,"click"],["id","console",1,"console"],["name","targetType",3,"ngModel","ngModelChange"],["value","name"],["value","topic"],["value","id"],["value","type"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"form"),a.TgZ(4,"select",3),a.NdJ("ngModelChange",function(e){return t.source=e}),a.TgZ(5,"option",4),a._uU(6,"Queue"),a.qZA(),a.TgZ(7,"option",5),a._uU(8,"Router"),a.qZA(),a.TgZ(9,"option",6),a._uU(10,"Direct"),a.qZA(),a.qZA(),a.YNc(11,d,5,1,"select",7),a.YNc(12,u,7,1,"select",7),a.TgZ(13,"input",8),a.NdJ("ngModelChange",function(e){return t.target=e}),a.qZA(),a.TgZ(14,"button",9),a.NdJ("click",function(){return t.submit()}),a._uU(15,"Apply Filter"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(16,"div",10),a.TgZ(17,"input",11),a.NdJ("ngModelChange",function(e){return t.search=e})("input",function(e){return t.searching(e)}),a.qZA(),a.TgZ(18,"span",12),a.NdJ("click",function(){return t.toggleTime()}),a._uU(19,"Time"),a.qZA(),a.TgZ(20,"span",12),a.NdJ("click",function(){return t.toggleMessageId()}),a._uU(21,"Message Id"),a.qZA(),a.TgZ(22,"span",12),a.NdJ("click",function(){return t.toggleContentType()}),a._uU(23,"Content Type"),a.qZA(),a.TgZ(24,"span",12),a.NdJ("click",function(){return t.toggleAutoScroll()}),a._uU(25,"Auto Scroll"),a.qZA(),a.TgZ(26,"span",13),a.NdJ("click",function(){return t.clear()}),a._uU(27,"Clear Console"),a.qZA(),a.qZA(),a.qZA(),a._UZ(28,"div",14),a.qZA()),2&e&&(a.xp6(4),a.Q6J("ngModel",t.source),a.xp6(7),a.Q6J("ngIf","queue"==t.source),a.xp6(1),a.Q6J("ngIf","direct"==t.source),a.xp6(1),a.Q6J("ngModel",t.target),a.xp6(4),a.Q6J("ngModel",t.search),a.xp6(1),a.ekj("active",t.showTime),a.xp6(2),a.ekj("active",t.showMessageId),a.xp6(2),a.ekj("active",t.showContentType),a.xp6(2),a.ekj("active",t.autoScroll))},directives:[l._Y,l.JL,l.F,l.EJ,l.JJ,l.On,l.YN,l.Kr,o.O5,l.Fj],styles:['.console-frame[_ngcontent-%COMP%]{max-width:1400px;display:flex;flex-direction:column;margin:auto;align-content:stretch;align-items:stretch;height:calc(100vh - 110px)}.console-panel[_ngcontent-%COMP%]{display:flex;flex:0 1 auto;flex-direction:row;align-items:stretch;align-content:space-between}.console-filter[_ngcontent-%COMP%]{flex:1 0 auto;padding:0 0 12px}.console-filter[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;align-content:flex-start}.console-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:4px;border:1px solid #ccc;padding:6px;margin:0 10px 0 0;line-height:30px;height:32px;box-sizing:border-box}.console-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .console-buttons[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:4px;border:1px solid #ccc;box-sizing:border-box;padding:6px 8px;margin:0 10px 0 0;line-height:32px;height:32px}.console-filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:6px;border:none;background-color:#444;color:#eee;box-sizing:border-box;padding:6px 12px;margin:0 10px 0 0;height:32px;font-size:12px;font-weight:600;cursor:pointer}.console-filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#030303}.console-buttons[_ngcontent-%COMP%]{flex:0 1 auto;padding-top:0}.toggle-button[_ngcontent-%COMP%]{margin:0 4px;border-radius:6px;background-color:#dadada;color:#222;padding:8px 10px;line-height:20px;font-size:13px;font-weight:400;cursor:pointer}.toggle-button[_ngcontent-%COMP%]:hover{background-color:#d0d0d0}.toggle-button.active[_ngcontent-%COMP%]{background-color:#f0d000;color:#000}.toggle-button[_ngcontent-%COMP%]:hover.active{background-color:#f0e060}.red-button[_ngcontent-%COMP%]{margin:0 0 0 4px;border-radius:6px;background-color:#d01010;color:#fff;padding:8px 10px;line-height:20px;font-size:13px;font-weight:400;cursor:pointer}.red-button[_ngcontent-%COMP%]:hover{background-color:#ff3030}.console[_ngcontent-%COMP%]{background-color:#101010;flex:1 1 auto;border-radius:8px;display:flex;flex-direction:column;align-content:stretch;align-items:stretch;overflow:auto;padding:10px 14px;font-family:"Ubuntu Mono",monospace}']}),e})();var h=n(44139);let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[o.ez,l.u5,h.Bz.forChild([{path:"",component:p}])]]}),e})()}}]);