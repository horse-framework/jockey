import{a as Z}from"./chunk-BXDPRKZC.js";import{a as j}from"./chunk-NIIXPKXM.js";import{a as K}from"./chunk-V6JU363Q.js";import{a as V}from"./chunk-C32MIXKR.js";import{a as J}from"./chunk-AALDHFM7.js";import{a as X}from"./chunk-VHKLBTQQ.js";import{a as $}from"./chunk-Q3OZ3U72.js";import{a as C,b as U}from"./chunk-X7GHCXNM.js";import{a as g}from"./chunk-JSLFBEG5.js";import{c as A}from"./chunk-22RSRA5L.js";import{a as Y}from"./chunk-BQERTHYR.js";import{a as z}from"./chunk-DTICWRO3.js";import{a as G}from"./chunk-U2DSLRRK.js";import{a as F}from"./chunk-IARL6YQG.js";import{Aa as p,Bb as B,Fa as l,Ga as i,Ha as t,Ia as S,M as k,N as T,Pb as Q,Q as M,Qa as c,Xa as a,Ya as o,Za as u,d as y,db as W,ha as O,ia as n,ib as b,jb as f,l as x,q as _,ra as h,s as R,u as v,ua as q,ub as N,va as H,vb as L,xb as P,ya as w}from"./chunk-I3ZBIMQN.js";var E=class d{#e=M(B);load(){return this.#e.get("/dashboard/stats",{observe:"response"})}static \u0275fac=function(e){return new(e||d)};static \u0275prov=k({token:d,factory:d.\u0275fac,providedIn:"root"})};function ae(d,s){if(d&1&&(i(0,"div",19)(1,"p"),a(2,"That node is a "),i(3,"b"),a(4),t(),a(5," Node. "),i(6,"a",20),a(7,"Click here"),t(),a(8," to open main node jockey panel."),t()()),d&2){let e=c();n(4),o(e.dashboard.nodeState),n(2),l("href",W(e.dashboard.mainNodeHost),O)}}function ne(d,s){if(d&1&&(i(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24),a(4,"Queue Count"),t(),i(5,"div",25),a(6),t()(),i(7,"div",23)(8,"div",24),a(9,"Stored Messages"),t(),i(10,"div",25),a(11),t()(),i(12,"div",23)(13,"div",24),a(14,"Stored Priority Messages"),t(),i(15,"div",25),a(16),t()(),i(17,"div",23)(18,"div",24),a(19,"Pending Delivery"),t(),i(20,"div",25),a(21),t()(),i(22,"div",23)(23,"div",24),a(24,"Waiting for Put Back"),t(),i(25,"div",25),a(26),t()(),i(27,"div",23)(28,"div",24),a(29,"Processing"),t(),i(30,"div",25),a(31),t()()()()),d&2){let e=c();n(6),o(e.dashboard.queueCount),n(5),o(e.dashboard.queueStore.r),n(5),o(e.dashboard.queueStore.d),n(5),o(e.dashboard.queueStore.rs),n(5),o(e.dashboard.queueStore.nr),n(5),o(e.dashboard.queueStore.s)}}function re(d,s){if(d&1&&(i(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24),a(4,"Produced"),t(),i(5,"div",25),a(6),t()(),i(7,"div",23)(8,"div",24),a(9,"Acknowledged"),t(),i(10,"div",25),a(11),t()(),i(12,"div",23)(13,"div",24),a(14,"Negative Acknowledged"),t(),i(15,"div",25),a(16),t()(),i(17,"div",23)(18,"div",24),a(19,"Unacknowledge"),t(),i(20,"div",25),a(21),t()(),i(22,"div",23)(23,"div",24),a(24,"Acknowledge Timed out"),t(),i(25,"div",25),a(26),t()(),i(27,"div",23)(28,"div",24),a(29,"Delivery Errors"),t(),i(30,"div",25),a(31),t()()()()),d&2){let e=c();n(6),o(e.dashboard.queues.r),n(5),o(e.dashboard.queues.d),n(5),o(e.dashboard.queues.rs),n(5),o(e.dashboard.queues.nr),n(5),o(e.dashboard.queues.to),n(5),o(e.dashboard.queues.e)}}function de(d,s){if(d&1&&(i(0,"div",26)(1,"div",22)(2,"div",23)(3,"div",24),a(4,"Channel Count"),t(),i(5,"div",25),a(6),t()(),i(7,"div",23)(8,"div",24),a(9,"Published Messages"),t(),i(10,"div",25),a(11),t()(),i(12,"div",23)(13,"div",24),a(14,"Received Messages"),t(),i(15,"div",25),a(16),t()()()()),d&2){let e=c();n(6),o(e.dashboard.channelCount),n(5),o(e.dashboard.channels.s),n(5),o(e.dashboard.channels.r)}}function oe(d,s){if(d&1&&(i(0,"span"),a(1),t()),d&2){let e=s.$implicit;n(),o(e)}}function se(d,s){if(d&1&&(i(0,"em"),a(1),t()),d&2){let e=c(2);n(),u(" ",e.dashboard.queueOptions.ackTimeout," ms timeout ")}}function le(d,s){d&1&&(i(0,"div",25),a(1,"No Timeout"),t())}function me(d,s){if(d&1&&(i(0,"div",25),a(1),t()),d&2){let e=c(2);n(),u(" ",e.dashboard.queueOptions.msgTimeout," milliseconds ")}}function pe(d,s){d&1&&(i(0,"div",25),a(1,"No Delay"),t())}function ve(d,s){if(d&1&&(i(0,"div",25),a(1),t()),d&2){let e=c(2);n(),u(" ",e.dashboard.queueOptions.delayBetweenMsgs," milliseconds ")}}function ce(d,s){if(d&1&&(i(0,"div",27)(1,"div",26)(2,"div",22)(3,"div",23)(4,"div",24),a(5,"Service Lifetime"),t(),i(6,"div",25),a(7),t()(),i(8,"div",23)(9,"div",24),a(10,"Hostname"),t(),i(11,"div",25),p(12,oe,2,1,"span",28),t()(),i(13,"div",23)(14,"div",24),a(15,"Online Clients"),t(),i(16,"div",25),a(17),t()(),i(18,"div",23)(19,"div",29),a(20,"All defined remote nodes."),t(),i(21,"div",24),a(22,"Total Nodes"),t(),i(23,"div",25),a(24),t()(),i(25,"div",23)(26,"div",29),a(27,"Connected nodes"),t(),i(28,"div",24),a(29,"Online Nodes"),t(),i(30,"div",25),a(31),t()(),i(32,"div",23)(33,"div",24),a(34,"Channel Subscribers Limit"),t(),i(35,"div",25),a(36),b(37,"unlimited"),t()()()(),i(38,"div",26)(39,"div",22)(40,"div",23)(41,"div",24),a(42,"Max Queue Limit"),t(),i(43,"div",25),a(44),b(45,"unlimited"),t()(),i(46,"div",23)(47,"div",24),a(48,"Max Router Limit"),t(),i(49,"div",25),a(50),b(51,"unlimited"),t()(),i(52,"div",23)(53,"div",24),a(54,"Auto Channel Creation"),t(),i(55,"div",25),a(56),t()(),i(57,"div",23)(58,"div",24),a(59,"Auto Queue Creation"),t(),i(60,"div",25),a(61),t()(),i(62,"div",23)(63,"div",24),a(64,"Auto Queue Destroy"),t(),i(65,"div",25),a(66),t()(),i(67,"div",23)(68,"div",24),a(69,"Queue Subscribers Limit"),t(),i(70,"div",25),a(71),b(72,"unlimited"),t()()()(),i(73,"div",26)(74,"div",22)(75,"div",23)(76,"div",24),a(77,"Default Queue Type"),t(),i(78,"div",25),a(79),t()(),i(80,"div",23)(81,"div",24),a(82,"Queue Acknowledge"),t(),i(83,"div",25),a(84),p(85,se,2,1,"em",30),t()(),i(86,"div",23)(87,"div",24),a(88,"Queue Message Timeout"),t(),p(89,le,2,0,"div",31)(90,me,2,1,"div",31),t(),i(91,"div",23)(92,"div",24),a(93,"Message Limit"),t(),i(94,"div",25),a(95),b(96,"unlimited"),i(97,"em"),a(98),b(99,"filesize"),t()()(),i(100,"div",23)(101,"div",24),a(102,"Delay Between Messages"),t(),p(103,pe,2,0,"div",31)(104,ve,2,1,"div",31),t()()()()),d&2){let e=c();n(7),o(e.lifetime),n(5),l("ngForOf",e.dashboard.server.hosts),n(5),o(e.dashboard.server.onlineClients),n(7),o(e.dashboard.server.totalNodes),n(7),o(e.dashboard.server.connectedNodes),n(5),o(f(37,21,e.dashboard.serverOptions.channelSubscriberLimit)),n(8),o(f(45,23,e.dashboard.serverOptions.queueLimit)),n(6),o(f(51,25,e.dashboard.serverOptions.routerLimit)),n(6),o(e.dashboard.serverOptions.autoChannelCreation),n(5),o(e.dashboard.queueOptions.autoQueueCreation),n(5),o(e.dashboard.queueOptions.autoDestroy),n(5),o(f(72,27,e.dashboard.queueOptions.clientLimit)),n(8),o(e.dashboard.queueOptions.type),n(5),u(" ",e.dashboard.queueOptions.ack," "),n(),l("ngIf",e.dashboard.queueOptions.ackTimeout>0),n(4),l("ngIf",e.dashboard.queueOptions.msgTimeout==0),n(),l("ngIf",e.dashboard.queueOptions.msgTimeout>0),n(5),u(" ",f(96,29,e.dashboard.queueOptions.msgLimit)," "),n(3),u("Size Limit: ",f(99,31,e.dashboard.queueOptions.msgSizeLimit)),n(5),l("ngIf",e.dashboard.queueOptions.delayBetweenMsgs==0),n(),l("ngIf",e.dashboard.queueOptions.delayBetweenMsgs>0)}}function he(d,s){if(d&1&&(i(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24),a(4,"Published Router Messages"),t(),i(5,"div",25),a(6),t()(),i(7,"div",23)(8,"div",24),a(9,"Delivered Router Messages"),t(),i(10,"div",25),a(11),t()(),i(12,"div",23)(13,"div",24),a(14,"Not Received Messages"),t(),i(15,"div",25),a(16),t()()()()),d&2){let e=c();n(6),o(e.dashboard.router.r),n(5),o(e.dashboard.router.s),n(5),o(e.dashboard.router.nr)}}function ue(d,s){if(d&1&&(i(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24),a(4,"Sent Direct Messages"),t(),i(5,"div",25),a(6),t()(),i(7,"div",23)(8,"div",24),a(9,"Delivered Direct Messages"),t(),i(10,"div",25),a(11),t()(),i(12,"div",23)(13,"div",24),a(14,"Direct Responses"),t(),i(15,"div",25),a(16),t()(),i(17,"div",23)(18,"div",24),a(19,"Not Routed Messages"),t(),i(20,"div",25),a(21),t()()()()),d&2){let e=c();n(6),o(e.dashboard.direct.s),n(5),o(e.dashboard.router.r),n(5),o(e.dashboard.direct.rs),n(5),o(e.dashboard.router.nr)}}var I=class d extends F{constructor(e,r,m,D,be,fe,xe,Se){super();this.dashboardService=e;this.socket=r;this.chartService=m;this.queueService=D;this.session=be;this.routerService=fe;this.channelService=xe;this.clientService=Se}deliveryChart=null;msgChart=null;storeChart=null;routerChart=null;channelChart=null;dashboard=null;lifetime="";ngOnInit(){return y(this,null,function*(){yield this.load(),this.on(R(5e3)).subscribe(()=>y(this,null,function*(){this.dashboardService.load().subscribe(r=>{this.dashboard=r.body})}));let e=this.session.state();e&&!this.socket.isConnected()?(this.socket.connect(e.token),this.on(this.socket.onconnected).subscribe(()=>this.subscribeWebsockets())):this.subscribeWebsockets()})}ngOnDestroy(){super.ngOnDestroy(),this.socket.unsubscribe("dashboard")}subscribeWebsockets(){this.on(this.socket.onmessage).pipe(v(e=>e.type==g.QueueGraph&&e.payload.n=="*"),v(()=>this.deliveryChart!=null),x(e=>e.payload)).subscribe(e=>this.chartService.updateChart(this.deliveryChart,e)),this.on(this.socket.onmessage).pipe(v(e=>e.type==g.QueueStoreGraph&&e.payload.n=="*"),v(()=>this.storeChart!=null),x(e=>e.payload)).subscribe(e=>this.chartService.updateChart(this.storeChart,e)),this.on(this.socket.onmessage).pipe(v(e=>e.type==g.DirectGraph&&e.payload.n=="*"),v(()=>this.msgChart!=null),x(e=>e.payload)).subscribe(e=>this.chartService.updateChart(this.msgChart,e)),this.on(this.socket.onmessage).pipe(v(e=>e.type==g.RouterGraph&&e.payload.n=="*"),v(()=>this.routerChart!=null),x(e=>e.payload)).subscribe(e=>this.chartService.updateChart(this.routerChart,e)),this.on(this.socket.onmessage).pipe(v(e=>e.type==g.ChannelGraph&&e.payload.n=="*"),v(()=>this.channelChart!=null),x(e=>e.payload)).subscribe(e=>this.chartService.updateChart(this.channelChart,e)),this.socket.subscribe("dashboard")}load(){return y(this,null,function*(){this.dashboardService.load().subscribe(r=>this.dashboard=r.body),this.loadCharts();let e=new V;this.on(R(1e3)).subscribe(()=>{if(!this.dashboard)return;let r=new Date().getTime()/1e3;this.lifetime=e.transform(r,this.dashboard.server.startedDate)})})}loadCharts(){_({queue:this.queueService.getGraph(""),channel:this.channelService.getGraph(""),router:this.routerService.getGraph(""),client:this.clientService.getGraph("")}).subscribe(e=>{this.deliveryChart&&this.deliveryChart.destroy(),this.deliveryChart=new C(document.getElementById("delivery-chart"),{type:"line",data:this.getDeliveryChartData(e.queue.body.stream),options:{animation:{duration:0},hover:{mode:"nearest",intersect:!0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}}),this.storeChart&&this.storeChart.destroy(),this.storeChart=new C(document.getElementById("store-chart"),{type:"line",data:this.getStoreChartData(e.queue.body.store),options:{animation:{duration:0},hover:{mode:"nearest",intersect:!0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}}),this.msgChart&&this.msgChart.destroy(),this.msgChart=new C(document.getElementById("msg-chart"),{type:"line",data:this.getMessageChartData(e.client?.d),options:{animation:{duration:0},hover:{mode:"nearest",intersect:!0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}}),this.routerChart&&this.routerChart.destroy(),this.routerChart=new C(document.getElementById("router-chart"),{type:"line",data:this.getRouterChartData(e.router.d),options:{animation:{duration:0},hover:{mode:"nearest",intersect:!0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}}),this.channelChart&&this.channelChart.destroy(),this.channelChart=new C(document.getElementById("channel-chart"),{type:"line",data:this.getChannelChartData(e.channel.d),options:{animation:{duration:0},hover:{mode:"nearest",intersect:!0},responsive:!0,scales:{x:{display:!1},y:{display:!0,ticks:{precision:0}}}}})})}getDeliveryChartData(e){return{labels:this.createLabels(e),datasets:[{label:"Produced",borderColor:"#2070e0",data:e.map(r=>r.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Ack",borderColor:"#12bf4a",data:e.map(r=>r.d),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Neg. Ack",borderColor:"#c042ef",data:e.map(r=>r.rs),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Unack",borderColor:"#eec236",data:e.map(r=>r.nr),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Error",borderColor:"#ff3333",data:e.map(r=>r.e),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]}}getStoreChartData(e){return{labels:this.createLabels(e),datasets:[{label:"Msgs",borderColor:"#2070e0",data:e.map(r=>r.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"High Prio Msgs",borderColor:"#ff9911",data:e.map(r=>r.d),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Pending for Ack",borderColor:"#10a0a0",data:e.map(r=>r.nr),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Processing",borderColor:"#f02020",data:e.map(r=>r.s),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]}}getMessageChartData(e){return{labels:this.createLabels(e),datasets:[{label:"Direct Sent",borderColor:"#2070e0",data:e.map(r=>r.s),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Direct Received",borderColor:"#f0f010",data:e.map(r=>r.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Direct Respond",borderColor:"#10cf70",data:e.map(r=>r.rs),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Direct No Receiver",borderColor:"#9a2ef0",data:e.map(r=>r.nr),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]}}getRouterChartData(e){return{labels:this.createLabels(e),datasets:[{label:"Router Publish",borderColor:"#2070e0",data:e.map(r=>r.s),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Router Received",borderColor:"#10c070",data:e.map(r=>r.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Router No Receiver",borderColor:"#f06010",data:e.map(r=>r.nr),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]}}getChannelChartData(e){return{labels:this.createLabels(e),datasets:[{label:"Published",borderColor:"#2070e0",data:e.map(r=>r.s),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Received",borderColor:"#10c070",data:e.map(r=>r.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]}}createLabels(e){let r=[];for(let m=0;m<e.length;m++){let D=e[m];r.push(z.findTimeFromUnixSeconds(D.u))}return r}static \u0275fac=function(r){return new(r||d)(h(E),h(A),h(U),h(J),h(j),h(X),h(Y),h(Z))};static \u0275cmp=q({type:d,selectors:[["app-dashboard"]],standalone:!1,features:[w],decls:50,vars:8,consts:[["class","warning-bar",4,"ngIf"],[1,"dashboard",3,"hidden"],[1,"dashboard-row"],[1,"dashboard-portlet"],[1,"portlet"],[1,"portlet-title"],[1,"portlet-body"],[1,"portlet-canvas"],["id","store-chart"],["class","portlet-table canvas-info",4,"ngIf"],["id","delivery-chart"],[1,"dashboard-portlet","dp-40"],[1,"portlet-canvas",2,"min-height","255px"],["id","channel-chart"],["class","portlet-table",4,"ngIf"],[1,"dashboard-portlet","dp-60"],["class","portlet-body","style","min-height: 275px;",4,"ngIf"],["id","router-chart"],["id","msg-chart"],[1,"warning-bar"],[3,"href"],[1,"portlet-table","canvas-info"],[1,"key-value-table"],[1,"kvt-row"],[1,"kvt-key"],[1,"kvt-value"],[1,"portlet-table"],[1,"portlet-body",2,"min-height","275px"],[4,"ngFor","ngForOf"],[1,"kvt-info"],[4,"ngIf"],["class","kvt-value",4,"ngIf"]],template:function(r,m){r&1&&(p(0,ae,9,3,"div",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),a(6,"Stored Queue Messages"),t(),i(7,"div",6)(8,"div",7),S(9,"canvas",8),t(),p(10,ne,32,6,"div",9),t()()(),i(11,"div",3)(12,"div",4)(13,"h3",5),a(14,"Queue Messages and Deliveries"),t(),i(15,"div",6)(16,"div",7),S(17,"canvas",10),t(),p(18,re,32,6,"div",9),t()()()(),i(19,"div",2)(20,"div",11)(21,"div",4)(22,"h3",5),a(23,"Channel Messages"),t(),i(24,"div",6)(25,"div",12),S(26,"canvas",13),t(),p(27,de,17,3,"div",14),t()()(),i(28,"div",15)(29,"div",4)(30,"h3",5),a(31,"Server Information and Default Options"),t(),p(32,ce,105,33,"div",16),t()()(),i(33,"div",2)(34,"div",3)(35,"div",4)(36,"h3",5),a(37,"Router Messages"),t(),i(38,"div",6)(39,"div",7),S(40,"canvas",17),t(),p(41,he,17,3,"div",9),t()()(),i(42,"div",3)(43,"div",4)(44,"h3",5),a(45,"Direct Messages and Responses"),t(),i(46,"div",6)(47,"div",7),S(48,"canvas",18),t(),p(49,ue,22,4,"div",9),t()()()()()),r&2&&(l("ngIf",m.dashboard&&(m.dashboard.nodeState=="Replica"||m.dashboard.nodeState=="Successor")),n(),l("hidden",m.dashboard==null),n(9),l("ngIf",m.dashboard),n(8),l("ngIf",m.dashboard),n(9),l("ngIf",m.dashboard),n(5),l("ngIf",m.dashboard),n(9),l("ngIf",m.dashboard),n(8),l("ngIf",m.dashboard))},dependencies:[N,L,$,K],encapsulation:2})};var te=class d{static \u0275fac=function(e){return new(e||d)};static \u0275mod=H({type:d});static \u0275inj=T({imports:[P,G,Q.forChild([{path:"",component:I}])]})};export{te as DashboardModule};
