"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[367],{7367:(L,u,a)=>{a.r(u),a.d(u,{ChannelDetailModule:()=>H});var h=a(9808),g=a(655),x=a(8332),Z=a.n(x),_=a(2962),T=a(8823),v=a(2198),y=a(4850),f=a(2986),M=a(8929),e=a(6435),r=a(6663),c=a(4182);function b(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"input",8),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().model.value=i}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngModel",t.model.value)}}function O(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"select",9),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().model.value=i}),e.TgZ(1,"option",10),e._uU(2,"Yes"),e.qZA(),e.TgZ(3,"option",10),e._uU(4,"No"),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("ngModel",t.model.value),e.xp6(1),e.Q6J("ngValue",!0),e.xp6(2),e.Q6J("ngValue",!1)}}let A=(()=>{class n{constructor(){this._onconfirmed=new M.xQ,this.model={confirmed:!1,title:"",property:"",value:null,type:"text"},this._confirmed=!1}get onconfirmed(){return this._onconfirmed}ngOnInit(){}confirm(){this._confirmed=!0,this.model.confirmed=!0,this._onconfirmed.next(this.model)}ngOnDestroy(){this._confirmed||(this.model.confirmed=!1,this._onconfirmed.next(this.model))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-channel-option-modal"]],decls:13,vars:3,consts:[["mat-dialog-title","",1,"title"],[1,"content"],[1,"form-item"],["placeholder","Option Value","class","target-text","type","text",3,"ngModel","ngModelChange",4,"ngIf"],["class","jockey-select",3,"ngModel","ngModelChange",4,"ngIf"],[1,"buttons"],["mat-button","","mat-dialog-close","",1,"modal-btn","btn-green",3,"click"],["mat-button","","mat-dialog-close","",1,"modal-btn","btn-grey"],["placeholder","Option Value","type","text",1,"target-text",3,"ngModel","ngModelChange"],[1,"jockey-select",3,"ngModel","ngModelChange"],[3,"ngValue"]],template:function(t,o){1&t&&(e.TgZ(0,"h2",0),e._uU(1,"Channel Option Change"),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"label"),e._uU(5),e.qZA(),e.YNc(6,b,1,1,"input",3),e.YNc(7,O,5,3,"select",4),e.qZA()(),e.TgZ(8,"mat-dialog-actions",5)(9,"button",6),e.NdJ("click",function(){return o.confirm()}),e._uU(10,"Confirm"),e.qZA(),e.TgZ(11,"button",7),e._uU(12,"Cancel"),e.qZA()()),2&t&&(e.xp6(5),e.Oqu(o.model.title),e.xp6(1),e.Q6J("ngIf","text"==o.model.type),e.xp6(1),e.Q6J("ngIf","checkbox"==o.model.type))},directives:[r.uh,r.xY,h.O5,c.Fj,c.JJ,c.On,c.EJ,c.YN,c.Kr,r.H8,r.ZT],styles:[".title[_ngcontent-%COMP%]{color:#eee}.content[_ngcontent-%COMP%]{padding:0 25px 10px;display:block}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d2d2d2;font-size:14px;line-height:30px}.content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:20px 0}.target-text[_ngcontent-%COMP%]{border:1px solid #555;background-color:#000;color:#eee;font-size:14px;font-weight:500;padding:8px;width:320px}.target-text[_ngcontent-%COMP%]:focus, .target-text[_ngcontent-%COMP%]:active{border-color:#10a040}.form-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;align-content:stretch;align-items:stretch;justify-content:stretch;justify-items:stretch;padding:8px 0}.form-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1 1 auto;color:#bbb;font-size:13px;text-transform:uppercase;padding:4px 0;font-weight:500}.form-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1 1 auto;width:432px}.form-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1 1 auto;width:450px}"]}),n})();var U=a(8782),D=a(970),p=a(823),N=a(6072),I=a(5608),q=a(379),k=a(8392);function J(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"a",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).viewInitialMessage()}),e._uU(1,"View"),e.qZA()}}function S(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"div",20),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"div",21),e._uU(7),e.TgZ(8,"a",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().remove()}),e._uU(9,"Delete"),e.qZA()()(),e.TgZ(10,"div",19)(11,"div",20),e._uU(12,"Topic"),e.qZA(),e.TgZ(13,"div",21),e._uU(14),e.TgZ(15,"a",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.changeOption("Topic","topic",i.channel.topic)}),e._uU(16,"Change"),e.qZA()()(),e.TgZ(17,"div",19)(18,"div",20),e._uU(19,"Status"),e.qZA(),e.TgZ(20,"div",21),e._uU(21),e.qZA()(),e.TgZ(22,"div",19)(23,"div",20),e._uU(24,"Initial Message"),e.qZA(),e.TgZ(25,"div",21),e._uU(26),e.YNc(27,J,2,0,"a",23),e.qZA()(),e.TgZ(28,"div",19)(29,"div",20),e._uU(30,"Client Limit"),e.qZA(),e.TgZ(31,"div",21),e._uU(32),e.ALo(33,"unlimited"),e.TgZ(34,"a",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.changeOption("Client Limit","clientLimit",i.channel.options.clientLimit)}),e._uU(35,"Change"),e.qZA()()(),e.TgZ(36,"div",19)(37,"div",20),e._uU(38,"Message Size Limit"),e.qZA(),e.TgZ(39,"div",21),e._uU(40),e.ALo(41,"unlimited"),e.TgZ(42,"a",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.changeOption("Message Size Limit","messageSizeLimit",i.channel.options.messageSizeLimit)}),e._uU(43,"Change"),e.qZA()()(),e.TgZ(44,"div",19)(45,"div",20),e._uU(46,"Auto Destroy"),e.qZA(),e.TgZ(47,"div",21),e._uU(48),e.TgZ(49,"a",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.changeOption("Auto Destroy","autoDestroy",i.channel.options.autoDestroy,"checkbox")}),e._uU(50,"Change"),e.qZA()()(),e.TgZ(51,"div",19)(52,"div",20),e._uU(53,"Auto Destroy Idle"),e.qZA(),e.TgZ(54,"div",21),e._uU(55),e.TgZ(56,"a",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.changeOption("Auto Destroy Idle","autoDestroyIdleSeconds",i.channel.options.autoDestroyIdleSeconds)}),e._uU(57,"Change"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.hij(" ",t.channel.name," "),e.xp6(7),e.hij(" ",t.channel.topic," "),e.xp6(7),e.Oqu(t.channel.status),e.xp6(5),e.hij(" ",t.channel.hasInitialMessage?"":"None"," "),e.xp6(1),e.Q6J("ngIf",t.channel.hasInitialMessage),e.xp6(5),e.hij(" ",e.lcZ(33,9,t.channel.options.clientLimit)," "),e.xp6(8),e.hij(" ",e.lcZ(41,11,t.channel.options.messageSizeLimit)," "),e.xp6(8),e.hij(" ",t.channel.options.autoDestroy?"Yes":"No"," "),e.xp6(7),e.hij(" ",t.channel.options.autoDestroyIdleSeconds," Seconds ")}}function w(n,l){if(1&n&&(e.TgZ(0,"div",26)(1,"div",27)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"div",27)(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"div",28)(8,"a",29),e._uU(9),e.qZA()(),e.TgZ(10,"div",30)(11,"span"),e._uU(12),e.ALo(13,"date"),e.qZA()()()),2&n){const t=l.$implicit;e.xp6(3),e.Oqu(t.type),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.MGl("routerLink","/client/",t.id,""),e.xp6(1),e.Oqu(t.id),e.xp6(3),e.Oqu(e.xi3(13,5,1e3*t.subscriptionDate,"yyyy-MM-dd HH:mm:ss"))}}function P(n,l){if(1&n&&(e.TgZ(0,"div",24),e.YNc(1,w,14,8,"div",25),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.channel.subscribers)}}let Y=(()=>{class n extends _.H{constructor(t,o,i,s,C,d){super(),this.activatedRoute=t,this.service=o,this.socket=i,this.dialog=s,this.router=C,this.chartService=d}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){this.channelName=this.activatedRoute.snapshot.params.name,yield this.load(),this.subscribeWebsockets()})}ngOnDestroy(){super.ngOnDestroy(),this.socket.unsubscribe("channel:"+this.channelName)}load(){return(0,g.mG)(this,void 0,void 0,function*(){this.channel=yield this.service.get(this.channelName);let t=yield this.service.getGraph(this.channelName,"1m");this.channelChart&&this.channelChart.destroy(),this.channelChart=new(Z())(document.getElementById("messages-chart"),{type:"line",hover:{mode:"nearest",intersect:!0},data:{labels:t.labels,datasets:[{label:"Published",borderColor:"#2070e0",data:t.d.map(o=>o.s),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2},{label:"Received",borderColor:"#10c070",data:t.d.map(o=>o.r),fill:!1,pointRadius:1,pointHitRadius:8,lineTension:.2,borderWidth:2}]},options:{animation:{duration:0},responsive:!0,scales:{xAxes:[{display:!1}],yAxes:[{display:!0,ticks:{precision:0}}]}}})})}subscribeWebsockets(){this.on(this.socket.onmessage).pipe((0,v.h)(t=>t.type==T.S.ChannelGraph&&t.payload.n==this.channelName),(0,v.h)(()=>null!=this.channelChart),(0,y.U)(t=>t.payload)).subscribe(t=>this.chartService.updateChart(this.channelChart,t)),this.socket.subscribe("channel:"+this.channelName,"1m")}changeOption(t,o,i,s="text"){let d=this.dialog.open(A,{width:"500px"}).componentInstance;d.model.title=t,d.model.property=o,d.model.value=i,d.model.type=s,d.onconfirmed.pipe((0,f.q)(1)).subscribe(m=>{m.confirmed&&this.service.setOption(this.channelName,m.property,m.value).then(()=>this.load())})}remove(){let o=this.dialog.open(U.z,{width:"600px"}).componentInstance;o.message='You are about to delete <b class="imp">'+this.channelName+"</b> Channel. Are you sure?",o.onclosed.pipe((0,f.q)(1)).subscribe(i=>{i&&this.service.remove(this.channelName).then(s=>{this.router.navigateByUrl("/channels")})})}viewInitialMessage(){this.dialog.open(D.n,{width:"800px"}).componentInstance.load(this.channelName)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(N.T),e.Y36(I.i),e.Y36(r.uw),e.Y36(p.F0),e.Y36(q.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-channel-detail"]],features:[e.qOj],decls:30,vars:2,consts:[[1,"centered-body"],[1,"vertical-content"],[1,"dashboard-portlet"],[1,"portlet"],[1,"portlet-title"],[1,"portlet-canvas"],["id","messages-chart"],["class","portlet-body",4,"ngIf"],[1,"portlet","full"],[1,"portlet-body","table","table-small"],[1,"thead"],[1,"th","fx24"],[1,"th","fx30"],[1,"th","fx22"],["class","tbody",4,"ngIf"],[2,"height","80px"],[1,"portlet-body"],[1,"portlet-table","grow","canvas-info"],[1,"key-value-table"],[1,"kvt-row"],[1,"kvt-key"],[1,"kvt-value"],[1,"change-option",3,"click"],["class","change-option",3,"click",4,"ngIf"],[1,"tbody"],["class","trow",4,"ngFor","ngForOf"],[1,"trow"],[1,"td","fx24"],[1,"td","fx30"],[3,"routerLink"],[1,"td","fx22"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5,"Channel Messages"),e.qZA(),e.TgZ(6,"div",5),e._UZ(7,"canvas",6),e.qZA()()(),e.TgZ(8,"div",2)(9,"div",3)(10,"h3",4),e._uU(11,"Options & Actions"),e.qZA(),e.YNc(12,S,58,13,"div",7),e.qZA()()()(),e.TgZ(13,"div",0)(14,"div",1)(15,"div",8)(16,"h3",4),e._uU(17,"Channel Subscribers"),e.qZA(),e.TgZ(18,"div",9)(19,"div",10)(20,"div",11),e._uU(21,"Type"),e.qZA(),e.TgZ(22,"div",11),e._uU(23,"Name"),e.qZA(),e.TgZ(24,"div",12),e._uU(25,"Id"),e.qZA(),e.TgZ(26,"div",13),e._uU(27,"Subscribed Date"),e.qZA()(),e.YNc(28,P,2,1,"div",14),e.qZA()()()(),e._UZ(29,"div",15)),2&t&&(e.xp6(12),e.Q6J("ngIf",o.channel),e.xp6(16),e.Q6J("ngIf",o.channel))},directives:[h.O5,h.sg,p.yS],pipes:[k.O,h.uU],styles:[""]}),n})();var j=a(1887);let H=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[h.ez,j.D,r.Is,c.u5,p.Bz.forChild([{path:":name",component:Y}])]]}),n})()}}]);